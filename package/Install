; EAB WHDLoad Games AGA Menu Package Install Script
; -------------------------------------------------
;
; Author: Henrik Noerfjand Stengaard
; Date: 2017-01-16
;
; This script extracts and installs zip archives for EAB WHDLoad Games AGA Menu Package.

echo "Installing HstWB Games..."
unzip -qq -o -x PACKAGEDIR:hstwb-games.zip -d SYSTEMDIR:Games/

echo "Installing Menu and WHDLoad drawers..."
unzip -qq -o -x PACKAGEDIR:menu-whdload-drawers.zip -d WHDLOADDIR:

echo "Installing AGS2 Games Menu..."
unzip -qq -o -x PACKAGEDIR:ags2games-menu.zip -d WHDLOADDIR:Menu/AGS2Games/
protect >NIL: WHDLOADDIR:Menu/AGS2Games/AGS2 +rwe
protect >NIL: WHDLOADDIR:Menu/AGS2Games/AGS2Helper +rwe
protect >NIL: WHDLOADDIR:Menu/AGS2Games/AGS2Menu +rwe
IF NOT EXISTS "WHDLOADDIR:Menu/AGS2Games/Music"
  makedir "WHDLOADDIR:Menu/AGS2Games/Music" >NIL:
ENDIF
IF NOT EXISTS "WHDLOADDIR:Menu/AGS2Games/.Favourites.ags"
  IF NOT EXISTS "WHDLOADDIR:Menu/AGS2Games/.Favourites.ag_"
    makedir "WHDLOADDIR:Menu/AGS2Games/.Favourites.ag_" >NIL:
  ENDIF
ENDIF

echo "Installing Menu WHDLoad Content..."
unzip -qq -o -x PACKAGEDIR:menu-whdload-content.zip -d WHDLOADDIR:WHDLoad/Games/

; Add A-Games to user-assign, if it doesn't exist
search SYSTEMDIR:S/User-Assign "A-Games:" >NIL:
IF WARN 
	echo "Assign A-Games: DH1:WHDLoad/Games" >>SYSTEMDIR:S/User-Assign
ENDIF

; Add HD-Games to user assign, if it doesn't exist
search SYSTEMDIR:S/User-Assign "HD-Games:" >NIL:
IF WARN 
	echo "Assign HD-Games: DH1:HD-Games" >>SYSTEMDIR:S/User-Assign
ENDIF

; Add ags2 games menu dir to ags2menu.data, if it doesn't exist
search SYSTEMDIR:S/AGS2Menu.data "AGS2GamesMenuDir=" >NIL:
IF WARN 
	echo "AGS2GamesMenuDir=DH1:Menu/AGS2Games" >>SYSTEMDIR:S/AGS2Menu.data
ENDIF

; Add igame games menu dir to igamemenu.data, if it doesn't exist
search SYSTEMDIR:S/iGameMenu.data "iGameGamesMenuDir=" >NIL:
IF WARN 
	echo "iGameGamesMenuDir=DH0:Games" >>SYSTEMDIR:S/iGameMenu.data
ENDIF
